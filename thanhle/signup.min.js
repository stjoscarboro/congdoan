var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(b,a,e){b instanceof String&&(b=String(b));for(var d=b.length,f=0;f<d;f++){var g=b[f];if(a.call(e,g,f,b))return{i:f,v:g}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(b,a,e){b!=Array.prototype&&b!=Object.prototype&&(b[a]=e.value)};$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(b,a,e,d){if(a){e=$jscomp.global;b=b.split(".");for(d=0;d<b.length-1;d++){var f=b[d];f in e||(e[f]={});e=e[f]}b=b[b.length-1];d=e[b];a=a(d);a!=d&&null!=a&&$jscomp.defineProperty(e,b,{configurable:!0,writable:!0,value:a})}};$jscomp.polyfill("Array.prototype.find",function(b){return b?b:function(a,b){return $jscomp.findInternal(this,a,b).v}},"es6","es3");$jscomp.owns=function(b,a){return Object.prototype.hasOwnProperty.call(b,a)};
$jscomp.assign="function"==typeof Object.assign?Object.assign:function(b,a){for(var e=1;e<arguments.length;e++){var d=arguments[e];if(d)for(var f in d)$jscomp.owns(d,f)&&(b[f]=d[f])}return b};$jscomp.polyfill("Object.assign",function(b){return b||$jscomp.assign},"es6","es3");var $jscomp$destructuring$var0=require("../resources/js/angular-app.js"),app=$jscomp$destructuring$var0.app;require("../resources/js/parish-service.js");require("./signup.scss");
(function(){var b=function(a,b,d,f,g){a.init=function(){a.total=120;a.formData={};a.listIndex=0;a.signups=[];a.nav={};e()};a.submit=function(){var d=[];a.signupData=[];f.loadSignups().then(function(c){a.signups=c;a.signups.forEach(function(b){var h=a.formData[b.date],c=b.data.find(function(a){return a.email===h.email});c?(c.name=h.name,c.phone=h.phone,c.count=h.count):(c=g.pick(h,"name","email","phone","count"),c.order=b.data.length+1,b.data.push(c));d.push(f.updateSignup(b).then(function(){0<c.count&&
(Object.assign(c,g.pick(b,"date","liturgy")),a.signupData.push(c))}))});b.all(d).then(function(){a.signupData.sort(function(a,b){b=b.date;return a.date.getTime()<b.getTime()?-1:1});location.hash="/summary"})})};a.formatDate=function(a,b){var c=a.toLocaleTimeString([],{hour:"numeric",minute:"2-digit"});a=$.datepicker.formatDate("dd/mm/yy",a);return a+" @"+c+" - "+b};a.formatPhone=function(a){return(a||"").replace(/(\d{3})(\d{3})(\d{4})/,"($1) $2-$3")};a.getRemaining=function(b){var c=a.signups.find(function(a){return a.date.getTime()===
b.getTime()}),d=a.total;c.data.forEach(function(a){d-=a.count||0});return d};a.checkSignup=function(b){var c=a.formData[b];c&&(a.signups.forEach(function(b){a.formData[b.date]={};Object.assign(a.formData[b.date],g.pick(c,"name","email","phone"));b.data.forEach(function(a){if(c.email&&a.email===c.email||c.name&&a.name===c.name||c.phone&&a.phone===c.phone)Object.assign(c,g.pick(a,"email","count")),""!==c.name&&Object.assign(c,g.pick(a,"name")),""!==c.phone&&Object.assign(c,g.pick(a,"phone"))})}),a.signups.forEach(function(b){Object.assign(a.formData[b.date],
g.pick(c,"name","email","phone"));b.data.forEach(function(c){c.email===a.formData[b.date].email&&Object.assign(a.formData[b.date],g.pick(c,"count"))})}),$(".content .name").trigger("oninput"),$(".content .email").trigger("oninput"),$(".content .count").trigger("oninput"))};a.prevList=function(){$("html").scrollTop(0,0);0<a.listIndex&&--a.listIndex;k()};a.nextList=function(){a.listIndex<a.signups.length-1&&(a.listIndex+=1);$("html").scrollTop(0,0);k()};var e=function(){a.signups&&0!==a.signups.length||
l();d.addEventListener("hashchange",function(b){a.signups?(/\/signup$/.test(b.newURL)&&a.$apply(function(){a.signupData&&0<a.signupData.length&&a.checkSignup(a.signupData[0].date)}),/\/summary$/.test(b.newURL)&&!a.signupData&&(location.hash="/signup")):l()})},l=function(){f.loadSignups().then(function(b){a.signups=b;k();/\/(signup|list)$/.test(location.hash)||(location.hash="/signup")})},k=function(){a.nav.prev=0===a.listIndex?"disabled":"";a.nav.next=a.listIndex===a.signups.length-1?"disabled":""}};
b.$inject=["$scope","$q","$window","ParishService","AppUtil"];app.controller("thanhle",b)})();(function(){var b=function(a,b){var d=location.pathname.split("/")[1];a.when("/summary",{templateUrl:"/"+d+"/thanhle/summary.html"}).when("/list",{templateUrl:"/"+d+"/thanhle/list.html"}).otherwise({templateUrl:"/"+d+"/thanhle/signup.html"});b.hashPrefix("")};b.$inject=["$routeProvider","$locationProvider"];app.config(b)})();
