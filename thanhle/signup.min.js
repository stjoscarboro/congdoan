var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,b,c){a instanceof String&&(a=String(a));for(var e=a.length,d=0;d<e;d++){var h=a[d];if(b.call(c,h,d,a))return{i:d,v:h}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,b,c,e){if(b){c=$jscomp.global;a=a.split(".");for(e=0;e<a.length-1;e++){var d=a[e];d in c||(c[d]={});c=c[d]}a=a[a.length-1];e=c[a];b=b(e);b!=e&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(b,a){return $jscomp.findInternal(this,b,a).v}},"es6","es3");$jscomp.owns=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)};
$jscomp.assign="function"==typeof Object.assign?Object.assign:function(a,b){for(var c=1;c<arguments.length;c++){var e=arguments[c];if(e)for(var d in e)$jscomp.owns(e,d)&&(a[d]=e[d])}return a};$jscomp.polyfill("Object.assign",function(a){return a||$jscomp.assign},"es6","es3");var $jscomp$destructuring$var0=require("../resources/js/angular-app.js"),app=$jscomp$destructuring$var0.app;require("../resources/js/parish-service.js");require("./signup.scss");
(function(){var a=function(b,a,e,d){b.init=function(){b.total=120;b.formData={};k()};b.submit=function(){var c=[];b.signupData=[];b.signups.forEach(function(a){var g=b.formData[a.date],f=a.data.find(function(a){return a.email===g.email});f?(f.name=g.name,f.phone=g.phone,f.count=g.count):(f=d.pick(g,"name","email","phone","count"),f.order=a.data.length+1,a.data.push(f));c.push(e.updateSignup(a).then(function(){0<f.count&&(Object.assign(f,d.pick(a,"date","liturgy")),b.signupData.push(f))}))});a.all(c).then(function(){b.signupData.sort(function(a,
b){b=b.date;return a.date.getTime()<b.getTime()?-1:1});location.hash="/summary"})};b.formatDate=function(a,b){var c=a.toLocaleTimeString([],{hour:"numeric",minute:"2-digit"});a=$.datepicker.formatDate("dd/mm/yy",a);return a+" @"+c+" "+(b?"- "+b.name:"")};b.formatPhone=function(a){return(a||"").replace(/(\d{3})(\d{3})(\d{4})/,"($1) $2-$3")};b.getRemaining=function(a){var c=b.signups.find(function(b){return b.date.getTime()===a.getTime()}),d=b.total;c.data.forEach(function(a){d-=a.count||0});return d};
b.checkSignup=function(a){var c=b.formData[a];c&&(b.signups.forEach(function(a){b.formData[a.date]={};Object.assign(b.formData[a.date],d.pick(c,"name","email","phone"));a.data.forEach(function(a){if(c.name&&a.name===c.name||c.email&&a.email===c.email||c.phone&&a.phone===c.phone)Object.assign(c,d.pick(a,"email","count")),""!==c.name&&Object.assign(c,d.pick(a,"name")),""!==c.phone&&Object.assign(c,d.pick(a,"phone"))})}),b.signups.forEach(function(a){Object.assign(b.formData[a.date],d.pick(c,"name",
"email","phone"));a.data.forEach(function(c){c.email===b.formData[a.date].email&&Object.assign(b.formData[a.date],d.pick(c,"count"))})}))};var c=function(){e.loadSignups().then(function(a){b.signups=a;/\/(signup|list)$/.test(location.hash)||(location.hash="/signup")})},k=function(){b.signups||c();window.onhashchange=function(a){b.signups?/\/signup$/.test(a.newURL)&&b.$apply(function(){b.signupData&&0<b.signupData.length&&b.checkSignup(b.signupData[0].date)}):c()}}};a.$inject=["$scope","$q","ParishService",
"AppUtil"];app.controller("thanhle",a)})();(function(){var a=function(a,c){var b=location.pathname.split("/")[1];a.when("/summary",{templateUrl:"/"+b+"/thanhle/summary.html"}).when("/list",{templateUrl:"/"+b+"/thanhle/list.html"}).otherwise({templateUrl:"/"+b+"/thanhle/signup.html"});c.hashPrefix("")};a.$inject=["$routeProvider","$locationProvider"];app.config(a)})();
