var $jscomp$destructuring$var0=require("./angular-app.js"),app=$jscomp$destructuring$var0.app,$jscomp$destructuring$var1=require("./app-secret.js"),airtable=$jscomp$destructuring$var1.airtable;require("./airtable-service.js");
(function(){var c=function(c,h,f,k){var e={},d={url:atob(airtable.url.parish),token:atob(airtable.token),tables:{mass:{fields:["date","active","data","liturgy"]}}};h.defaults.headers.common.Authorization="Bearer "+d.token;e.loadSignups=function(){var a=c.defer(),g=new Date;f.getData("mass",d).then(function(c){var e=[];c.sort(function(a,b){a=a.date;b=b.date;return a.getTime()<b.getTime()?-1:a.getTime()>b.getTime()?1:0});for(var d=0;d<c.length;d++){var b=c[d];b.active&&(b.allow=108E5<b.date.getTime()-
g.getTime(),b.list=b.date.getTime()>g.getTime(),b.data=b.data?JSON.parse(b.data):[],e.push(b))}a.resolve(e)});return a.promise};e.updateSignup=function(a){var c=l(a);return f.updateData("mass",d,a.refId,c)};var l=function(a){a.data=a.data.map(function(a){return k.pick(a,"name","email","phone","count","order")});return{fields:{data:JSON.stringify(a.data)}}};return e};c.$inject=["$q","$http","AirtableService","AppUtil"];app.factory("ParishService",c)})();
