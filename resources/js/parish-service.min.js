var $jscomp$destructuring$var0=require("./angular-app.js"),app=$jscomp$destructuring$var0.app,$jscomp$destructuring$var1=require("./app-secret.js"),airtable=$jscomp$destructuring$var1.airtable;require("./airtable-service.js");
(function(){var d=function(d,c,f,k){c={};var g={url:atob(airtable.url.parish),key:atob(airtable.key),tables:{mass:{fields:["date","active","data","liturgy"]}}};c.loadSignups=function(){var a=d.defer(),h=new Date;f.getData("mass",g).then(function(c){var d=[];c.sort(function(a,b){a=a.date;b=b.date;return a.getTime()<b.getTime()?-1:a.getTime()>b.getTime()?1:0});for(var e=0;e<c.length;e++){var b=c[e];b.active&&(b.allow=108E5<b.date.getTime()-h.getTime(),b.list=b.date.getTime()>h.getTime(),b.data=b.data?
JSON.parse(b.data):[],d.push(b))}a.resolve(d)});return a.promise};c.updateSignup=function(a){var c=l(a);return f.updateData("mass",g,a.refId,c)};var l=function(a){a.data=a.data.map(function(a){return k.pick(a,"name","email","phone","count","order")});return{fields:{data:JSON.stringify(a.data)}}};return c};d.$inject=["$q","$http","AirtableService","AppUtil"];app.factory("ParishService",d)})();
