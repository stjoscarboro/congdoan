var $jscomp$destructuring$var0=require("./angular-app.js"),app=$jscomp$destructuring$var0.app,$jscomp$destructuring$var1=require("./app-secret.js"),airtable=$jscomp$destructuring$var1.airtable;require("./airtable-service.js");require("./liturgy-service.js");
(function(){var c=function(c,b,d,k,f){b={};var e={url:atob(airtable.url.parish),key:atob(airtable.key),tables:{mass:{fields:["date","active","data","liturgy"]}}};b.loadSignups=function(){var a=c.defer(),g=new Date;d.getData("mass",e).then(function(b){b.sort(function(a,b){a=a.date;b=b.date;return a.getTime()<b.getTime()?-1:a.getTime()>b.getTime()?1:0});var c=[];b.forEach(function(a){a.active&&a.date.getTime()>g.getTime()&&(a.data=a.data?JSON.parse(a.data):[],c.push(a))});a.resolve(c)});return a.promise};
b.updateSignup=function(a){var b=h(a);return d.updateData("mass",e,a.refId,b)};var h=function(a){a.data=a.data.map(function(a){return f.pick(a,"name","email","phone","count","order")});return{fields:{date:a.date,active:!!a.active,data:JSON.stringify(a.data),liturgy:a.liturgy}}};return b};c.$inject=["$q","$http","AirtableService","LiturgyService","AppUtil"];app.factory("ParishService",c)})();
