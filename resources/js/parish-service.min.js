var $jscomp$destructuring$var0=require("./angular-app.js"),app=$jscomp$destructuring$var0.app,$jscomp$destructuring$var1=require("./app-secret.js"),airtable=$jscomp$destructuring$var1.airtable;require("./airtable-service.js");require("./liturgy-service.js");
(function(){var c=function(c,b,e,l,h){b={};var f={url:atob(airtable.url.parish),key:atob(airtable.key),tables:{mass:{fields:["date","active","data","liturgy"]}}};b.loadSignups=function(){var a=c.defer(),g=new Date;e.getData("mass",f).then(function(b){b.sort(function(d,a){d=d.date;a=a.date;return d.getTime()<a.getTime()?-1:d.getTime()>a.getTime()?1:0});var c=[];b.forEach(function(a){a.active&&(a.allow=108E5<a.date.getTime()-g.getTime(),a.list=a.date.getTime()>g.getTime(),a.data=a.data?JSON.parse(a.data):
[],c.push(a))});a.resolve(c)});return a.promise};b.updateSignup=function(a){var b=k(a);return e.updateData("mass",f,a.refId,b)};var k=function(a){a.data=a.data.map(function(a){return h.pick(a,"name","email","phone","count","order")});return{fields:{data:JSON.stringify(a.data)}}};return b};c.$inject=["$q","$http","AirtableService","LiturgyService","AppUtil"];app.factory("ParishService",c)})();
